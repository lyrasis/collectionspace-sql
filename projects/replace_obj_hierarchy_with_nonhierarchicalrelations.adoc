.Child objects of hierarchy
[source,sql]
----
SELECT cc.objectnumber, cohc.descriptionlevel, rd.item AS department, hier.name AS csid
  FROM collectionobjects_common AS cc
  INNER JOIN collectionobjects_ohc AS cohc ON 
  cc.id = cohc.id AND 
  (cohc.descriptionlevel = 'urn:cspace:cspace.ohiohistory.org:vocabularies:name(descriptionlevel):item:name(item)''item'''
   OR
   cohc.descriptionlevel = 'urn:cspace:cspace.ohiohistory.org:vocabularies:name(descriptionlevel):item:name(groupofitems1553529920283)''group of items'''
  )
  INNER JOIN collectionobjects_common_responsibledepartments AS rd ON
  cc.id = rd.id AND
  ( rd.item = 'archaeology'
      OR
    rd.item = 'archaeology-nagpra'
      OR
    rd.item = 'ethnographic'
  )
  INNER JOIN misc ON misc.id = cc.id AND misc.lifecyclestate != 'deleted'
  INNER JOIN hierarchy AS hier ON cc.id = hier.id
  WHERE 
  cc.objectnumber LIKE 'A %'
----


.Existing hierarchical rels
[source,sql]
----
WITH depts AS (
	SELECT id, STRING_AGG(item, '|') AS departments
	FROM collectionobjects_common_responsibledepartments
	GROUP BY id
  ),
children AS (
	SELECT DISTINCT cc.id, cc.objectnumber, hier.name AS csid, cohc.descriptionlevel, depts.departments AS dept
  FROM collectionobjects_common AS cc
  INNER JOIN collectionobjects_ohc AS cohc ON 
  cc.id = cohc.id AND 
  (cohc.descriptionlevel = 'urn:cspace:cspace.ohiohistory.org:vocabularies:name(descriptionlevel):item:name(item)''item'''
   OR
   cohc.descriptionlevel = 'urn:cspace:cspace.ohiohistory.org:vocabularies:name(descriptionlevel):item:name(groupofitems1553529920283)''group of items'''
  )
  INNER JOIN collectionobjects_common_responsibledepartments AS rd ON
  cc.id = rd.id AND
  ( rd.item = 'archaeology'
      OR
    rd.item = 'archaeology-nagpra'
      OR
    rd.item = 'ethnographic'
  )
  INNER JOIN misc ON misc.id = cc.id AND misc.lifecyclestate != 'deleted'
  INNER JOIN hierarchy AS hier ON cc.id = hier.id
  LEFT JOIN depts ON cc.id = depts.id
  WHERE 
  cc.objectnumber LIKE 'A %'
	)
SELECT children.objectnumber AS childobjnum, 
REGEXP_REPLACE(children.descriptionlevel, $$.*'(.*)'$$, '\1', 'g') AS childdesclevel,
children.dept AS childdept, 
rel.subjectcsid AS childcsid, 
rel.relationshiptype, 
cc.objectnumber AS parentobjnum,
REGEXP_REPLACE(cohc.descriptionlevel, $$.*'(.*)'$$, '\1', 'g') AS parentdesclevel,
depts.departments AS parentdept,
rel.objectcsid AS parentcsid 
FROM relations_common rel
INNER JOIN children ON (
	children.csid = rel.subjectcsid
	AND
	rel.relationshiptype = 'hasBroader'
	)
INNER JOIN misc ON misc.id = rel.id AND misc.lifecyclestate != 'deleted'
INNER JOIN hierarchy hier ON rel.objectcsid = hier.name
INNER JOIN collectionobjects_common cc ON hier.id = cc.id
LEFT OUTER JOIN collectionobjects_ohc cohc ON cc.id = cohc.id
LEFT JOIN depts ON cc.id = depts.id
----
